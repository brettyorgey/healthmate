<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>FifthQtr Healthmate</title>
  <style>
    body { font-family: system-ui, sans-serif; margin:0; background:#f9fafb; display:flex; flex-direction:column; height:100vh; }
    header { background:#0a2342; color:#fff; padding:16px; font-size:20px; font-weight:600; }
    #chat { flex:1; overflow-y:auto; padding:16px; }
    .msg { margin:10px 0; max-width:80%; padding:12px 14px; border-radius:12px; white-space:pre-wrap; }
    .user { margin-left:auto; background:#eef2ff; }
    .assistant { background:#fff; border:1px solid #ddd; }
    #inputbar { display:flex; padding:12px; background:#fff; border-top:1px solid #ddd; }
    #inputbar input { flex:1; padding:12px; border:1px solid #ccc; border-radius:8px; font-size:16px; }
    #inputbar button { margin-left:8px; padding:12px 18px; background:#0a2342; color:#fff; border:none; border-radius:8px; cursor:pointer; font-size:16px; }
    footer { font-size:12px; color:#6b7280; padding:8px 16px; background:#fff; border-top:1px solid #ddd; }
  </style>
</head>
<body>
  <header>FifthQtr Healthmate</header>
  <div id="chat"></div>
  <div id="inputbar">
    <input id="msg" placeholder="Type your question…" />
    <button id="send">Send</button>
  </div>
  <footer>
    This service provides general information only. Please see your GP for medical advice. In an emergency call <strong>000</strong>.
  </footer>

  <script>
    const ENDPOINT = "/api/mascot"; // relative path works on Vercel

    const chat = document.getElementById('chat');
    const input = document.getElementById('msg');
    const sendBtn = document.getElementById('send');

    function addMsg(role, text) {
      const div = document.createElement('div');
      div.className = 'msg ' + role;
      div.textContent = text;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
    }

    async function sendMsg() {
      const text = input.value.trim();
      if (!text) return;
      addMsg('user', text);
      input.value = '';
      try {
        const r = await fetch(ENDPOINT, {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify({ message: text })
        });
        const j = await r.json();
        addMsg('assistant', j.output || 'Sorry—I could not generate a response.');
      } catch (e) {
        addMsg('assistant','Sorry—network error.');
      }
    }

    sendBtn.onclick = sendMsg;
    input.addEventListener('keydown', e => { if (e.key === 'Enter') sendMsg(); });
  </script>
</body>
</html>
